# 2021년 10월 8일 (금)

## http 헤더

### http 전송에 필요한 모든 부가정보를 담고있다. ex) 메세지 바디의 내용 및 크기, 인증, 요청, 서버정보 등등

#### 헤더에는 표현 데이터의 형식을 나타내는 content-type, 표현 데이터의 압축 방식을 나타내는 content-encoding 등등이 있다.

## http 바디

### 메세지 본문(message body)을 통해 표현 데이터를 전달한다. 메세지 본문 = 페이로드(payload)

#### 표현은 요청이나 응답에서 전달할 실제 데이터를 의미한다. 표현 헤더는 표현 데이터를 해석할 수 있는 정보를 제공한다. ex) 데이터 유형: html, json 등등

## 협상(콘텐츠 네고시에이션) -> 클라이언트가 선호하는 표현 요청

### 협상에는 총 4가지가 있다. Accept: 클라이언트가 선호하는 미디어 타입 전달, Accept-Charset: 클라이언트가 선호하는 문자 인코딩, Accept-Encoding: 클라이언트가 선호하는 압축 인코딩, Accept-Language: 클라이언트가 선호하는 자연언어

### 협상과 우선순위에서는 Quality Values(q)값을 사용한다. 0 ~ 1 사이 값으로 클수록 높은 우선순위를 의미한다. q를 생략하면 자동적으로 1을 의미하게 된다.

```
ex) Accept-Language: ko-KR, ko;q=0.9, en-US;q=0.8, en;q=0.7
```

### 구체적인 것이 우선한다. -> Accept: text, text/plain, text/plain;format=flowed. 즉, 구체적으로 적은 것들로 먼저 협상의 우선순위로 배치가 된다.

## 전송방식

### 전송방식에는 단순 전송, 압축 전송, 분할 전송, 범위 전송 4가지가 존재 한다.

#### 단순 전송은 컨텐츠의 길이를 알 수 있을 때 사용하는 방식으로 헤더에 Content-Length를 포함한다.

#### 압축 전송은 서버에서 자료를 압축하여 보내는 방식으로 Content-encoding에 무엇으로 압축하였는지 표기해줘여 한다.

#### 분할 전송은 용량이 큰 자료를 한번에 보내기 보다는 분할하여 보내는 방식이다. 헤더에 Transfer-Encoding: chunked로 표기된다. 중요한 점은 Content-Length를 표기하면 안된다. 왜냐하면 분할하여 보내기 때문에 정확한 예측이 불가하기 때문이다.

#### 범위 전송은 범위를 지정해서 자료를 요청하면 서버에서 Content-Range에 범위를 표기하여 요청 자료를 보내주는 방식이다.

### Request 헤더에는 Referer라는 것이 있다.

#### 현재 요청된 페이지의 이전 웹 페이지 주소를 가리킨다. A -> B로 이동하는 경우 B를 요청할 때 Referer: A를 포함해서 요청한다. 이 Referer를 이용하면 유입 경로를 분석할 수 있다.

### Host 헤더 -> 요청한 호스트 정보(도메인)

#### 요청에서 사용하며 필수 값이다. 하나의 서버가 여러 도메인을 처리해야 할 때 구분해주는 역할을 한다.

### Location -> 페이지 리다이렉션

#### 웹 브라우저는 3xx 응답의 결과에 Location 헤더가 있으면, Location 위치로 자동 이동(Redirect)한다.

## Cookie

### Cookie를 사용할 때는 두개의 헤더(Set-Cookie -> 서버에서 클라이언트로 쿠기 전달(응답), Cookie -> (클라이언트가 서버에서 받은 쿠키를 저장하고, HTTP 요청시 서버로 전달))를 사용한다.

#### 쿠키의 주 사용처는 사용자 로그인 세션관리, 광고 정보 트래킹이다.

#### 쿠키 정보는 항상 서버에 전송이 된다. 그러므로, 네트워크 트래픽을 추가 유발시킨다. 이를 방지하기 위해 최소한의 정보만 사용해야 한다. ex)세션 id, 인증 토큰. 보안에 민감한 데이터는 저장하면 안된다.

### 쿠키의 생명주기

#### Set-Cookie: expires=Sat, 26-Dec-2020 12:00:00 GMT -> 이 날짜가 되면 만료인로써 쿠기가 삭제된다.

#### Set-Cookie: max-age=3600 (= 3600초) -> 0 이나 음수를 지정하면 쿠키가 삭제됨

#### 쿠키에는 두 가지 종류가 있는데 첫번째는 세션쿠키로 만료 날짜를 생략하면 브라우저 종료시 까지만 유지가 된다. 두번째는 영속쿠키로 만료 날짜를 입력하면 해당 날짜까지 유지한다.

### 경로(Path)

#### 경로를 지정하면 ex) path=/home -> 이 경로를 포함한 하위 경로 페이지만 쿠키 접근이 가능하다. 일반적으로 path=/ 루트로 값을 지정한다.

### 보안

#### Secure를 적용하면 주소가 https인 경우에만 전송한다.

#### httpOnly를 적용하면 XSS 공격을 방지한다. http 전송에만 사용하며 자바스크립트에서 접근이 불가하다. ex) document.cookie
